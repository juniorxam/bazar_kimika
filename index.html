<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>BazarPlus - Gestão de Bazares e Créditos</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="stylesheet" href="styles.css">
    
    <script src="script.js"></script>
</head>
<body>
    
    <main class="main-content">
        <header class="header">
            <h1>BazarKimika - Gestão de Bazares e Créditos</h1>
            <div class="header-actions">
                <button class="theme-toggle" onclick="toggleTheme()">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="user-info">
                    Olá, FRAN
                    <img src="https://via.placeholder.com/40/8b5cf6/ffffff?text=LP" alt="User Avatar">
                </div>
            </div>
        </header>

        <nav class="tab-nav">
            <button class="tab-button" onclick="showTab('dashboard')">
                <i class="fas fa-chart-line"></i> Dashboard
            </button>
            <button class="tab-button" onclick="showTab('vendas')">
                <i class="fas fa-shopping-cart"></i> Vendas
            </button>
            <button class="tab-button" onclick="showTab('consumos')">
                <i class="fas fa-credit-card"></i> Consumos
            </button>
            <button class="tab-button" onclick="showTab('itens')">
                <i class="fas fa-box"></i> Itens/Estoque
            </button>
            <button class="tab-button" onclick="showTab('consignatarios')">
                <i class="fas fa-users"></i> Consignatários
            </button>
            <button class="tab-button" onclick="showTab('compradores')">
                <i class="fas fa-user-tag"></i> Compradores
            </button>
            <button class="tab-button" onclick="showTab('bazares')">
                <i class="fas fa-store"></i> Bazares
            </button>
            <button class="tab-button" onclick="showTab('configuracoes')">
                <i class="fas fa-cogs"></i> Configurações
            </button>
        </nav>
        
        <div class="tab-container">

            <div id="dashboard" class="tab-content active">
                <h2>Dashboard de Vendas e Estoque</h2>
                
                <div class="filtros-container">
                    <select id="filterMes" onchange="filtrarDashboard()">
                        <option value="">Todo Período</option>
                        </select>
                    <select id="filterBazar" onchange="filtrarDashboard()">
                        <option value="">Todos os Bazares</option>
                    </select>
                    <select id="filterConsignatario" onchange="filtrarDashboard()">
                        <option value="">Todos os Consignatários</option>
                    </select>
                </div>

                <div class="dashboard-grid">
                    <div class="card card-primary">
                        <h3>Total de Vendas</h3>
                        <p id="cardTotalVendas" class="data-value"></p>
                    </div>
                    <div class="card card-success">
                        <h3>Comissão da Loja</h3>
                        <p id="cardTotalComissao" class="data-value"></p>
                    </div>
                    <div class="card card-info">
                        <h3>Itens Vendidos</h3>
                        <p id="cardItensVendidos" class="data-value"></p>
                    </div>
                    <div class="card card-warning">
                        <h3>Estoque Atual</h3>
                        <p id="cardEstoqueAtual" class="data-value"></p>
                    </div>
                    <div class="card card-danger">
                        <h3>Crédito Pendente</h3>
                        <p id="cardCreditoPendente" class="data-value"></p>
                    </div>
                    <div class="card card-secondary">
                        <h3>Consignatários C/ Crédito</h3>
                        <p id="cardConsignatariosPendentes" class="data-value"></p>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-card">
                        <h3>Vendas por Período</h3>
                        <canvas id="chartVendasMes"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>Vendas por Forma de Pagamento</h3>
                        <canvas id="chartVendasPagamento"></canvas>
                    </div>
                </div>
            </div>

            <div id="vendas" class="tab-content">
                <h2>Registro de Vendas</h2>
                <form id="formVenda" class="form-grid">
                    <div class="form-group">
                        <label for="vendaItemId">Item Vendido</label>
                        <select id="vendaItemId" onchange="atualizarValorVenda()" required>
                            <option value="">Selecione o Item...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vendaCompradorId">Comprador</label>
                        <select id="vendaCompradorId" required>
                            <option value="">Selecione o Comprador...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vendaValor">Valor da Venda (R$)</label>
                        <input type="number" id="vendaValor" min="0.01" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="vendaPagamento">Forma de Pagamento</label>
                        <select id="vendaPagamento" required>
                            <option value="">Selecione...</option>
                            <option value="PIX">PIX</option>
                            <option value="Cartao">Cartão</option>
                            <option value="Dinheiro">Dinheiro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="vendaData">Data da Venda</label>
                        <input type="date" id="vendaData" required>
                    </div>
                    <div class="action-buttons full-width">
                        <button type="button" onclick="registrarVenda()" class="btn btn-success">
                            <i class="fas fa-cash-register"></i> Registrar Venda
                        </button>
                    </div>
                </form>

                <h3>Histórico de Vendas</h3>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Item</th>
                                <th>Consignatário</th>
                                <th>Comprador</th>
                                <th>Valor</th>
                                <th>Crédito Gerado</th>
                                <th>Data</th>
                                <th>Pagamento</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaVendasBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="consumos" class="tab-content">
                <h2>Registro de Consumos / Retiradas de Crédito</h2>
                <form id="formConsumo" class="form-grid">
                    <div class="form-group">
                        <label for="consumoConsignatarioId">Consignatário</label>
                        <select id="consumoConsignatarioId" required>
                            <option value="">Selecione o Consignatário...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="consumoValor">Valor (R$)</label>
                        <input type="number" id="consumoValor" min="0.01" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="consumoDescricao">Descrição</label>
                        <input type="text" id="consumoDescricao" placeholder="Ex: Retirada via PIX" required>
                    </div>
                    <div class="form-group">
                        <label for="consumoData">Data do Consumo</label>
                        <input type="date" id="consumoData" required>
                    </div>
                    <div class="action-buttons full-width">
                        <button type="button" onclick="registrarConsumo()" class="btn btn-warning">
                            <i class="fas fa-money-check-alt"></i> Registrar Consumo / Pagamento
                        </button>
                    </div>
                </form>

                <h3>Histórico de Consumos</h3>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Consignatário</th>
                                <th>Descrição</th>
                                <th>Valor</th>
                                <th>Data</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaConsumosBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="itens" class="tab-content">
                <h2>Cadastro de Itens de Consignação</h2>
                <form id="formItem" class="form-grid">
                    <div class="form-group">
                        <label for="itemDescricao">Descrição do Item</label>
                        <input type="text" id="itemDescricao" placeholder="Ex: Vestido de Festa Azul" required>
                    </div>
                    <div class="form-group">
                        <label for="itemConsignatarioId">Consignatário</label>
                        <select id="itemConsignatarioId" required>
                            <option value="">Selecione...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="itemValor">Valor Original (R$)</label>
                        <input type="number" id="itemValor" min="0.01" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="itemQuantidade">Quantidade</label>
                        <input type="number" id="itemQuantidade" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="itemBazarId">Bazar de Origem</label>
                        <select id="itemBazarId" required>
                            <option value="">Selecione...</option>
                        </select>
                    </div>
                    <div class="action-buttons full-width">
                        <button type="button" id="itemSalvar" onclick="adicionarItem()" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Adicionar Item
                        </button>
                    </div>
                </form>

                <h3>Estoque e Itens Cadastrados</h3>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Descrição</th>
                                <th>Consignatário</th>
                                <th>Valor</th>
                                <th>Qtd</th>
                                <th>Bazar</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaItensBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="consignatarios" class="tab-content">
                <h2>Cadastro de Consignatários (Donos dos Itens)</h2>
                <form id="formConsignatario" class="form-grid">
                    <div class="form-group">
                        <label for="consignatarioNome">Nome</label>
                        <input type="text" id="consignatarioNome" required>
                    </div>
                    <div class="form-group">
                        <label for="consignatarioTelefone">Telefone</label>
                        <input type="text" id="consignatarioTelefone" placeholder="(99) 99999-9999">
                    </div>
                    <div class="form-group">
                        <label for="consignatarioEmail">E-mail</label>
                        <input type="email" id="consignatarioEmail">
                    </div>
                    <div class="action-buttons full-width">
                        <button type="button" id="consignatarioSalvar" onclick="adicionarConsignatario()" class="btn btn-primary">
                            <i class="fas fa-user-plus"></i> Adicionar Consignatário
                        </button>
                    </div>
                </form>
                
                <h3>Lista de Consignatários</h3>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Crédito (A Pagar)</th>
                                <th>Total Vendas</th>
                                <th>Telefone</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaConsignatariosBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="compradores" class="tab-content">
                <h2>Cadastro de Compradores</h2>
                <form id="formComprador" class="form-grid">
                    <div class="form-group">
                        <label for="compradorNome">Nome</label>
                        <input type="text" id="compradorNome" required>
                    </div>
                    <div class="form-group">
                        <label for="compradorTelefone">Telefone</label>
                        <input type="text" id="compradorTelefone" placeholder="(99) 99999-9999">
                    </div>
                    <div class="action-buttons full-width">
                        <button type="button" id="compradorSalvar" onclick="adicionarComprador()" class="btn btn-primary">
                            <i class="fas fa-user-plus"></i> Adicionar Comprador
                        </button>
                    </div>
                </form>

                <h3>Lista de Compradores</h3>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Total Compras</th>
                                <th>Qtd Compras</th>
                                <th>Telefone</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaCompradoresBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="bazares" class="tab-content">
                <h2>Cadastro de Bazares</h2>
                <form id="formBazar" class="form-grid">
                    <div class="form-group">
                        <label for="bazarNome">Nome do Bazar</label>
                        <input type="text" id="bazarNome" required>
                    </div>
                    <div class="form-group">
                        <label for="bazarInicio">Data de Início</label>
                        <input type="date" id="bazarInicio" required>
                    </div>
                    <div class="form-group">
                        <label for="bazarFim">Data de Fim (Opcional)</label>
                        <input type="date" id="bazarFim">
                    </div>
                    <div class="action-buttons full-width">
                        <button type="button" id="bazarSalvar" onclick="criarBazar()" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Criar Bazar
                        </button>
                    </div>
                </form>

                <h3>Lista de Bazares</h3>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Início</th>
                                <th>Fim</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaBazaresBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="configuracoes" class="tab-content">
                <h2>Configurações do Sistema e Utilitários</h2>
                
                <div class="config-section">
                    <h3>Dados e Backup</h3>
                    <div class="action-buttons">
                        <button onclick="carregarDadosDeExemplo()" class="btn btn-info">
                            <i class="fas fa-seedling"></i> Carregar Dados de Exemplo
                        </button>
                        <button onclick="exportarDados()" class="btn btn-secondary">
                            <i class="fas fa-download"></i> Exportar Dados (JSON)
                        </button>
                        <button onclick="iniciarImportacao()" class="btn btn-secondary">
                            <i class="fas fa-upload"></i> Importar Dados (JSON)
                        </button>
                        <button onclick="limparTudo()" class="btn btn-danger">
                            <i class="fas fa-trash-alt"></i> Limpar TODOS os Dados
                        </button>
                    </div>
                </div>

                <div class="config-section">
                    <h3>Regras Financeiras e Operacionais</h3>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label for="percentualConsignatario">Percentual Consignatário (%)</label>
                            <input type="number" id="percentualConsignatario" min="0" max="100" value="80" required>
                        </div>
                        <div class="form-group">
                            <label for="percentualLoja">Percentual Loja (%)</label>
                            <input type="number" id="percentualLoja" min="0" max="100" value="20" required>
                        </div>
                        <div class="form-group">
                            <label for="validadeCredito">Validade do Crédito (Meses)</label>
                            <input type="number" id="validadeCredito" min="1" value="6" required>
                        </div>
                        <div class="form-group">
                            <label for="alertaEstoque">Alerta de Estoque Baixo (Itens)</label>
                            <input type="number" id="alertaEstoque" min="1" value="5" required>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button onclick="salvarConfiguracoes()" class="btn btn-primary">
                            <i class="fas fa-save"></i> Salvar Configurações
                        </button>
                    </div>
                </div>
            </div>
            
        </div>
    </main>

    <div id="notification-area"></div>
    <input type="file" id="importFile" accept="application/json" style="display: none;" onchange="processarImportacao(event)">

</body>
</html>
